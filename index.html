<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Escalation – Squads & Plantões</title>

    <!-- TailwindCSS via CDN (Play CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>

<style>
  /* ... */
</style>
    <script>
      // ✅ Paleta centralizada – altere aqui e o app todo acompanha
      tailwind.config = {
  theme: {
    extend: {
      fontFamily: {
        // Define 'sans' como a fonte padrão para todo o corpo
        sans: ['Inter', 'sans-serif'], 
      },
      colors: {
        // Tons mais suaves e profissionais
        primary: '#1e40af',   // Um azul mais escuro e sóbrio
        secondary: '#374151', // Cinza escuro para textos (em vez de preto)
        accent: '#1e40af',    // Usando o primário como destaque
        light: '#f9fafb',     // Um cinza bem claro para fundos de cards
        subtle: '#6b7280',    // Cinza para textos secundários (IDs, placeholders)
      }
    }
  }
}
    </script>

    <head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    </head>


    <!-- React 18 via CDN (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel Standalone: permite escrever JSX direto no browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      /* Evita highlight no duplo clique em botões no mobile */
      button { -webkit-tap-highlight-color: transparent; }
      /* Rolagem suave para UX */
      html { scroll-behavior: smooth; }
    </style>
  </head>
<body class="font-sans bg-light text-secondary">
    <div id="app"></div>

    <script type="text/babel" data-presets="env,react">
      const { useEffect, useMemo, useState } = React;

      const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJETO.firebaseapp.com",
  projectId: "SEU_PROJETO",
  // ... resto das suas credenciais
};

// Inicializa o Firebase
const app = firebase.initializeApp(firebaseConfig);
// Cria uma referência para o serviço do Firestore (nosso banco de dados)
const db = firebase.firestore();


      // ==========================
      // Escalation App (Single File – React via CDN)
      // - usando o Firebase
      // - CRUD de Squads e Plantonistas
      // - Busca + visual de consulta rápida
      // ==========================

      /** @typedef {{ id: string, name: string }} Squad */
      /** @typedef {{ id: string, squadId: string, personName: string, phone: string, hours: string }} OnCall */

      const LS_KEY = "escalation_app_data_v1";

      function cryptoRandomId() {
        if (typeof crypto !== "undefined" && crypto.getRandomValues) {
          const a = new Uint32Array(2);
          crypto.getRandomValues(a);
          return (
            a[0].toString(36).slice(0, 4) + "-" + a[1].toString(36).slice(0, 6)
          );
        }
        return Math.random().toString(36).slice(2, 10);
      }

      const initialData = {
        squads: /** @type {Squad[]} */ ([
          { id: cryptoRandomId(), name: "Checkout" },
          { id: cryptoRandomId(), name: "Pagamentos" },
          { id: cryptoRandomId(), name: "Catálogo" },
        ]),
        oncalls: /** @type {OnCall[]} */ ([]),
      };

      function EscalationApp() {
        const [data, setData] = useLocalStorage(LS_KEY, initialData);
        const [query, setQuery] = useState("");
        const [view, setView] = useState({ page: "home", squadId: null });
        const [admin, setAdmin] = useState(false);
        const [toast, setToast] = useState(null);

        const squads = data.squads;
        const oncalls = data.oncalls;

        const filteredSquads = useMemo(() => {
          if (!query.trim()) return squads;
          const q = query.trim().toLowerCase();
          return squads.filter((s) => s.name.toLowerCase().includes(q));
        }, [query, squads]);

        const selectedSquad = useMemo(
          () => squads.find((s) => s.id === view.squadId) || null,
          [view, squads]
        );

        const selectedOnCalls = useMemo(
          () =>
            oncalls
              .filter((o) => o.squadId === view.squadId)
              .sort((a, b) => a.personName.localeCompare(b.personName)),
          [oncalls, view]
        );

        // ===== CRUD =====
        function addSquad(name) {
          const n = name?.trim();
          if (!n) return;
          const newSquad = { id: cryptoRandomId(), name: n };
          setData({ ...data, squads: [...squads, newSquad] });
          setToast(`Squad "${n}" criada.`);
        }

        function editSquad(id, name) {
          const n = name?.trim();
          if (!n) return;
          setData({
            ...data,
            squads: squads.map((s) => (s.id === id ? { ...s, name: n } : s)),
          });
          setToast("Squad atualizada.");
        }

        function deleteSquad(id) {
          if (!confirm("Remover esta squad e todos os plantonistas ligados a ela?"))
            return;
          setData({
            ...data,
            squads: squads.filter((s) => s.id !== id),
            oncalls: oncalls.filter((o) => o.squadId !== id),
          });
          if (view.squadId === id) setView({ page: "home", squadId: null });
          setToast("Squad removida.");
        }

        function addOnCall(squadId, payload) {
          const item = {
            id: cryptoRandomId(),
            squadId,
            personName: payload.personName.trim(),
            phone: payload.phone.trim(),
            hours: payload.hours.trim(),
          };
          setData({ ...data, oncalls: [...oncalls, item] });
          setToast("Plantonista adicionado.");
        }

        function editOnCall(id, payload) {
          setData({
            ...data,
            oncalls: oncalls.map((o) =>
              o.id === id
                ? {
                    ...o,
                    ...payload,
                    personName: payload.personName.trim(),
                    phone: payload.phone.trim(),
                    hours: payload.hours.trim(),
                  }
                : o
            ),
          });
          setToast("Plantonista atualizado.");
        }

        function deleteOnCall(id) {
          if (!confirm("Remover este plantonista?")) return;
          setData({ ...data, oncalls: oncalls.filter((o) => o.id !== id) });
          setToast("Plantonista removido.");
        }

        // ===== Import/Export =====
        function exportJson() {
          const blob = new Blob([JSON.stringify(data, null, 2)], {
            type: "application/json",
          });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `escalation-data-${new Date().toISOString().slice(0, 10)}.json`;
          a.click();
          URL.revokeObjectURL(url);
        }

        function importJson(file) {
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const parsed = JSON.parse(reader.result);
      if (!parsed || !Array.isArray(parsed.squads) || !Array.isArray(parsed.oncalls)) {
        alert("Arquivo inválido.");
        return;
      }
      setData(parsed);
      setToast("Dados importados (JSON).");
    } catch (e) {
      alert("Não foi possível ler o arquivo JSON.");
    }
  };
  reader.readAsText(file);
}

function importCsv(file) {
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const text = reader.result;
      const lines = text.split("\n").map(l => l.trim()).filter(Boolean);

      // primeira linha deve ser o cabeçalho
      const [header, ...rows] = lines;
      const cols = header.split(",");

      const oncalls = rows.map(row => {
        const values = row.split(",");
        const obj = {};
        cols.forEach((c, i) => obj[c.trim()] = values[i]?.trim());

        return {
          id: cryptoRandomId(),
          squadId: obj.squadId || "", // precisa ter a relação com squad
          personName: obj.personName || "",
          phone: obj.phone || "",
          hours: obj.hours || ""
        };
      });

      setData({ ...data, oncalls: [...data.oncalls, ...oncalls] });
      setToast("CSV importado com sucesso.");
    } catch (e) {
      alert("Erro ao importar CSV.");
    }
  };
  reader.readAsText(file);
}


        return (
          <div className="min-h-screen bg-primary/5 text-primary">
            <header className="sticky top-0 z-30 backdrop-blur bg-primary/80 border-b border-secondary text-white">
              <div className="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
                <Logo />
                <h1 className="text-xl sm:text-2xl font-semibold">Escalation – Squads & Plantões</h1>
                <div className="ml-auto flex items-center gap-2">
                  <button
                    className={`px-3 py-1.5 rounded-xl text-sm border ${
                      admin ? "bg-accent text-white" : "bg-white text-primary"
                    }`}
                    onClick={() => setAdmin((v) => !v)}
                    title="Alterna modo administrador (editar/inserir)"
                  >
                    {admin ? "Modo Admin: ON" : "Modo Admin: OFF"}
                  </button>
                  <button
                    onClick={exportJson}
                    className="px-3 py-1.5 rounded-xl text-sm border bg-accent text-white hover:bg-secondary"
                    title="Exportar dados em JSON"
                  >
                    Exportar
                  </button>
                 {/* Botão Importar */}
<label className="btn-primary">
  Importar
  <input
    type="file"
    accept=".json,.csv"
    className="hidden"
    onChange={(e) => {
      const f = e.target.files?.[0];
      if (f) {
        if (f.name.endsWith(".json")) importJson(f);
        else if (f.name.endsWith(".csv")) importCsv(f);
      }
      e.currentTarget.value = "";
    }}
  />
</label>
                </div>
              </div>
            </header>

            <main className="max-w-6xl mx-auto px-4 py-6">
              {view.page === "home" && (
                <HomeView
                  query={query}
                  setQuery={setQuery}
                  squads={filteredSquads}
                  onOpen={(id) => setView({ page: "detail", squadId: id })}
                  onCreateSquad={admin ? addSquad : undefined}
                  onEditSquad={admin ? editSquad : undefined}
                  onDeleteSquad={admin ? deleteSquad : undefined}
                />
              )}

              {view.page === "detail" && selectedSquad && (
                <DetailView
                  squad={selectedSquad}
                  onBack={() => setView({ page: "home", squadId: null })}
                  oncalls={selectedOnCalls}
                  onAdd={admin ? (payload) => addOnCall(selectedSquad.id, payload) : undefined}
                  onEdit={admin ? editOnCall : undefined}
                  onDelete={admin ? deleteOnCall : undefined}
                />
              )}

              {view.page === "detail" && !selectedSquad && (
                <div className="text-center py-20">Squad não encontrada.</div>
              )}
            </main>

            <footer className="max-w-6xl mx-auto px-4 pb-10 text-xs text-secondary">
              <p>
                Desenvolvido por Gustavo Pereira
              </p>
            </footer>

            {toast && (
              <Toast message={toast} onClose={() => setToast(null)} />
            )}
          </div>
        );
      }
      function importCsv(file) {
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const text = reader.result;
      const lines = text.split("\n").map(l => l.trim()).filter(Boolean);
      const [header, ...rows] = lines;
      const cols = header.split(",");

      const oncalls = rows.map(row => {
        const values = row.split(",");
        const obj = {};
        cols.forEach((c, i) => obj[c.trim()] = values[i]?.trim());
        return {
          id: cryptoRandomId(),
          squadId: obj.squadId,
          personName: obj.personName,
          phone: obj.phone,
          hours: obj.hours
        };
      });

      setData({ ...data, oncalls: [...data.oncalls, ...oncalls] });
      setToast("CSV importado com sucesso.");
    } catch (e) {
      alert("Erro ao importar CSV.");
    }
  };
  reader.readAsText(file);
}


      function HomeView({ query, setQuery, squads, onOpen, onCreateSquad, onEditSquad, onDeleteSquad }) {
        const [showNew, setShowNew] = useState(false);
        const [edit, setEdit] = useState(null); // { id, name }

        return (
          <div className="space-y-6">
            <div className="flex flex-col sm:flex-row gap-3 items-stretch sm:items-center">
              <input
                type="text"
                placeholder="Buscar squad…"
                value={query}
                onChange={(e) => setQuery(e.target.value)}
                className="w-full sm:w-96 px-4 py-2.5 border rounded-2xl focus:outline-none focus:ring-2 focus:ring-secondary"
              />
              {onCreateSquad && (
                <button
                  className="px-4 py-2.5 rounded-2xl bg-accent text-white hover:bg-secondary"
                  onClick={() => setShowNew(true)}
                >
                  Nova Squad
                </button>
              )}
            </div>

            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              {squads.map((s) => (
                <div
                  key={s.id}
    className="group border rounded-2xl p-4 bg-white hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 hover:scale-[1.02] flex flex-col"
                >
                  <div className="flex items-start gap-2">
                    <div className="flex-1">
                      <div className="text-lg font-medium text-primary">{s.name}</div>
                      <div className="text-xs text-secondary">ID: {s.id}</div>
                    </div>
                    <button
                      className="text-sm px-3 py-1 rounded-xl border bg-accent text-white hover:bg-secondary"
                      onClick={() => onOpen(s.id)}
                      title="Abrir detalhes"
                    >
                      Abrir
                    </button>
                  </div>

                  {onEditSquad && onDeleteSquad && (
                    <div className="mt-3 flex gap-2 opacity-0 group-hover:opacity-100 transition">
                      <button
                        className="text-xs px-3 py-1.5 rounded-xl border bg-white hover:bg-accent/10"
                        onClick={() => setEdit({ id: s.id, name: s.name })}
                      >
                        Editar
                      </button>
                      <button
                        className="text-xs px-3 py-1.5 rounded-xl border bg-white hover:bg-accent/10"
                        onClick={() => onDeleteSquad(s.id)}
                      >
                        Excluir
                      </button>
                    </div>
                  )}
                </div>
              ))}
            </div>

            {showNew && (
              <Modal title="Criar nova Squad" onClose={() => setShowNew(false)}>
                <SquadForm
                  onSubmit={(values) => {
                    onCreateSquad(values.name);
                    setShowNew(false);
                  }}
                />
              </Modal>
            )}

            {edit && (
              <Modal title="Editar Squad" onClose={() => setEdit(null)}>
                <SquadForm
                  defaultValues={{ name: edit.name }}
                  submitLabel="Salvar"
                  onSubmit={(values) => {
                    onEditSquad(edit.id, values.name);
                    setEdit(null);
                  }}
                />
              </Modal>
            )}
          </div>
        );
      }

      function DetailView({ squad, onBack, oncalls, onAdd, onEdit, onDelete }) {
        const [showNew, setShowNew] = useState(false);
        const [edit, setEdit] = useState(null); // oncall id

        return (
          <div className="space-y-6">
            <div className="flex items-center gap-2">
              <button
                onClick={onBack}
                className="px-3 py-1.5 rounded-xl border bg-accent text-white hover:bg-secondary"
              >
                Voltar
              </button>
              <h2 className="text-xl font-semibold text-primary">{squad.name}</h2>
            </div>

            <div className="flex justify-between items-center">
              <p className="text-sm text-secondary">
                Plantonistas cadastrados: <strong>{oncalls.length}</strong>
              </p>
              {onAdd && (
                <button
                  className="px-4 py-2.5 rounded-2xl bg-accent text-white hover:bg-secondary"
                  onClick={() => setShowNew(true)}
                >
                  Adicionar Plantonista
                </button>
              )}
            </div>

            {oncalls.length === 0 && (
              <div className="p-4 border rounded-2xl bg-white text-sm text-primary/80">
                Nenhum plantonista cadastrado para esta squad ainda.
              </div>
            )}

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              {oncalls.map((o) => (
                <div key={o.id} className="border rounded-2xl p-4 bg-white shadow-sm">
                  <div className="text-lg font-medium text-primary">{o.personName}</div>
                  <div className="text-sm text-primary/80 mt-1">
                    <div>Horário disponível: {o.hours || "—"}</div>
                    <div>
                      Telefone: {formatPhone(o.phone)}{" "}
                      <a
                        href={`tel:${o.phone.replace(/\D/g, "")}`}
                        className="ml-1 inline-block px-2 py-0.5 text-xs rounded-lg border"
                        title="Ligar agora"
                      >
                        Ligar
                      </a>
                    </div>
                    <div className="text-xs text-secondary mt-1">ID: {o.id}</div>
                  </div>

                  {(onEdit && onDelete) && (
                    <div className="mt-3 flex gap-2">
                      <button
                        className="text-xs px-3 py-1.5 rounded-xl border bg-white hover:bg-accent/10"
                        onClick={() => setEdit(o)}
                      >
                        Editar
                      </button>
                      <button
                        className="text-xs px-3 py-1.5 rounded-xl border bg-white hover:bg-accent/10"
                        onClick={() => onDelete(o.id)}
                      >
                        Excluir
                      </button>
                    </div>
                  )}
                </div>
              ))}
            </div>

            {showNew && (
              <Modal title={`Novo plantonista – ${squad.name}`} onClose={() => setShowNew(false)}>
                <OnCallForm
                  onSubmit={(values) => {
                    onAdd(values);
                    setShowNew(false);
                  }}
                />
              </Modal>
            )}

            {edit && (
              <Modal title={`Editar plantonista – ${squad.name}`} onClose={() => setEdit(null)}>
                <OnCallForm
                  defaultValues={edit}
                  submitLabel="Salvar"
                  onSubmit={(values) => {
                    onEdit(edit.id, values);
                    setEdit(null);
                  }}
                />
              </Modal>
            )}
          </div>
        );
      }
      
      function Button({ children, onClick, variant = 'primary', className = '' }) {
    const baseStyle = "px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 flex items-center justify-center gap-2";
    
    const variants = {
        primary: "bg-primary text-white hover:bg-primary/90 shadow-sm",
        secondary: "bg-light border text-secondary hover:bg-gray-200",
        danger: "bg-red-500 text-white hover:bg-red-600",
    };

    return (
        <button onClick={onClick} className={`${baseStyle} ${variants[variant]} ${className}`}>
            {children}
        </button>
    );
}


      function SquadForm({ defaultValues = { name: "" }, submitLabel = "Criar", onSubmit }) {
        const [name, setName] = useState(defaultValues.name);
        return (
          <form
            className="space-y-4"
            onSubmit={(e) => {
              e.preventDefault();
              if (!name.trim()) return;
              onSubmit({ name });
            }}
          >
            <label className="block">
              <div className="text-sm mb-1">Nome da Squad</div>
              <input
                className="w-full px-4 py-2.5 border rounded-2xl"
                value={name}
                onChange={(e) => setName(e.target.value)}
                placeholder="Ex.: Checkout"
                autoFocus
              />
            </label>
            <div className="pt-2 flex justify-end">
              <button className="px-4 py-2.5 rounded-2xl bg-accent text-white hover:bg-secondary">
                {submitLabel}
              </button>
            </div>
          </form>
        );
      }

      function OnCallForm({ defaultValues = { personName: "", phone: "", hours: "" }, submitLabel = "Adicionar", onSubmit }) {
        const [personName, setPersonName] = useState(defaultValues.personName || "");
        const [phone, setPhone] = useState(defaultValues.phone || "");
        const [hours, setHours] = useState(defaultValues.hours || "");

        return (
          <form
            className="space-y-4"
            onSubmit={(e) => {
              e.preventDefault();
              if (!personName.trim() || !phone.trim()) return;
              onSubmit({ personName, phone, hours });
            }}
          >
            <label className="block">
              <div className="text-sm mb-1">Nome do plantonista</div>
              <input
                className="w-full px-4 py-2.5 border rounded-2xl"
                value={personName}
                onChange={(e) => setPersonName(e.target.value)}
                placeholder="Ex.: Maria Silva"
                autoFocus
              />
            </label>
            <label className="block">
              <div className="text-sm mb-1">Telefone</div>
              <input
                className="w-full px-4 py-2.5 border rounded-2xl"
                value={phone}
                onChange={(e) => setPhone(formatPhoneTyping(e.target.value))}
                placeholder="(11) 91234-5678"
              />
            </label>
            <label className="block">
              <div className="text-sm mb-1">Horário disponível</div>
              <input
                className="w-full px-4 py-2.5 border rounded-2xl"
                value={hours}
                onChange={(e) => setHours(e.target.value)}
                placeholder="Ex.: Sáb-Dom 08:00–20:00"
              />
            </label>
            <div className="pt-2 flex justify-end">
              <button className="px-4 py-2.5 rounded-2xl bg-accent text-white hover:bg-secondary">
                {submitLabel}
              </button>
            </div>
          </form>
        );
      }

      function Modal({ title, children, onClose }) {
        useEffect(() => {
          const onKey = (e) => e.key === "Escape" && onClose();
          window.addEventListener("keydown", onKey);
          return () => window.removeEventListener("keydown", onKey);
        }, [onClose]);
        return (
          <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
            <div
              className="absolute inset-0 bg-black/30"
              onClick={onClose}
              role="button"
              aria-label="Fechar"
            />
            <div className="relative w-full max-w-lg bg-white rounded-3xl shadow-xl border p-5">
              <div className="flex items-center justify-between mb-3">
                <h3 className="text-lg font-semibold text-primary">{title}</h3>
                <button
                  onClick={onClose}
                  className="px-2 py-1 rounded-lg border text-sm bg-white hover:bg-accent/10"
                >
                  Fechar
                </button>
              </div>
              {children}
            </div>
          </div>
        );
      }

      function Toast({ message, onClose }) {
        useEffect(() => {
          const id = setTimeout(onClose, 2000);
          return () => clearTimeout(id);
        }, [onClose]);
        return (
          <div className="fixed bottom-4 left-1/2 -translate-x-1/2 z-50">
            <div className="px-4 py-2 rounded-xl bg-primary text-white text-sm shadow-lg">
              {message}
            </div>
          </div>
        );
      }

      function Logo() {
        return (
          <div className="w-8 h-8 rounded-2xl bg-secondary text-white grid place-items-center text-sm font-bold">
            ES
          </div>
        );
      }
      // Componente genérico para ícones
function Icon({ path, className = "w-5 h-5" }) {
    return (
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>
            <path strokeLinecap="round" strokeLinejoin="round" d={path} />
        </svg>
    );
}

// Ícones específicos
const EditIcon = () => <Icon path="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />;
const DeleteIcon = () => <Icon path="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />;
const PlusIcon = () => <Icon path="M12 4.5v15m7.5-7.5h-15" />;

// Exemplo no HomeView
<button onClick={() => setEdit({ id: s.id, name: s.name })}>
    <EditIcon /> 
    <span>Editar</span>
</button>

      // ---- Helpers ----
      function useLocalStorage(key, initialValue) {
        const [value, setValue] = useState(() => {
          try {
            const raw = localStorage.getItem(key);
            if (raw) return JSON.parse(raw);
          } catch {}
          return initialValue;
        });
        useEffect(() => {
          try {
            localStorage.setItem(key, JSON.stringify(value));
          } catch {}
        }, [key, value]);
        return [value, setValue];
      }

      function formatPhoneTyping(v) {
        // Aceita números brasileiros, mantém caracteres numéricos e formata conforme digitação
        const nums = v.replace(/\D/g, "").slice(0, 11);
        if (nums.length <= 2) return `(${nums}`;
        if (nums.length <= 6) return `(${nums.slice(0, 2)}) ${nums.slice(2)}`;
        if (nums.length <= 10)
          return `(${nums.slice(0, 2)}) ${nums.slice(2, 6)}-${nums.slice(6)}`;
        return `(${nums.slice(0, 2)}) ${nums.slice(2, 7)}-${nums.slice(7)}`; // 9 dígitos
      }
      

      function formatPhone(v) {
        const x = formatPhoneTyping(v);
        return x?.trim() || "";
      }
      

      // Monta o app
      const root = ReactDOM.createRoot(document.getElementById('app'));
      root.render(<EscalationApp />);
    </script>
  </body>
</html>
